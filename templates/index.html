{% extends "base.html" %}

{% block content %}
<section class="index-section">
    <h2 class="page-title">ì¥ë¥´ë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”</h2>

    <a href="{{ url_for('saved_tracks') }}" class="saved-link">ì €ì¥ëœ ìŒì•… ë³´ê¸°</a>

    <p class="page-subtitle">
        ë“£ê³  ì‹¶ì€ ìŒì•…ì˜ ë¶„ìœ„ê¸°ë¥¼ ê³¨ë¼ë³´ì„¸ìš”. ì¥ë¥´ë¥¼ ê²€ìƒ‰í•˜ê±°ë‚˜ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì¶”ì²œì„ ë°›ì•„ë³¼ ìˆ˜ ìˆì–´ìš” ğŸµ
    </p>

    <!-- ğŸ” ì¥ë¥´ ê²€ìƒ‰ì°½ -->
    <input
        type="text"
        id="genreSearch"
        class="genre-search"
        placeholder="ì¥ë¥´ ê²€ìƒ‰ (ì˜ˆ: rock, k-pop, jazz ...)"
        autocomplete="off"
    >

    <form action="{{ url_for('recommend') }}" method="post" class="genre-form">
        <!-- ğŸ”˜ ì¥ë¥´ ë²„íŠ¼ ëª©ë¡ -->
        <div class="genre-container">
            {% for g in genres %}
                <button 
                    type="submit"
                    name="genre"
                    value="{{ g }}"
                    class="genre-btn"
                    data-genre="{{ g | lower }}"
                >
                    {{ g }}
                </button>
            {% endfor %}
        </div>

        <div class="limit-row">
            <label for="limit">ì¶”ì²œ ë°›ì„ ê³¡ ê°œìˆ˜</label>
            <input type="number" id="limit" name="limit" value="10" min="1" max="30">
        </div>
    </form>
</section>

<!-- ğŸ” ê²€ìƒ‰ì–´ì— ë”°ë¼ ë²„íŠ¼ í•„í„°ë§ -->
<script>
    const searchInput = document.getElementById("genreSearch");
    const genreButtons = document.querySelectorAll(".genre-btn");

    searchInput.addEventListener("input", function () {
        const query = this.value.toLowerCase().trim();

        genreButtons.forEach(btn => {
            const genre = btn.dataset.genre;  // data-genre ê°’
            if (!query || genre.includes(query)) {
                btn.style.display = "inline-block";
            } else {
                btn.style.display = "none";
            }
        });
    });

    // ê²€ìƒ‰ì°½ì—ì„œ ì—”í„° ëˆŒë €ì„ ë•Œ í¼ ì œì¶œ ë°©ì§€
    searchInput.addEventListener("keydown", function (e) {
        if (e.key === "Enter") {
            e.preventDefault();
        }
    });
</script>
{% endblock %}
